process{
    withName: 'index_process' {
        container = "./container/bwa.sif"
        cpus = 24
        memory = '64GB'
        queue = 'ngen-ko'
        clusterOptions = '--job-name=index_ref --exclude=wuruwe,tokikura,v100'
        //containerOptions = '--bind /mnt/beegfs'
    }
    withName: 'mem_process' {
        container = "./container/bwa.sif"
        cpus = 24
        memory = '64GB'
        queue = 'ngen-ko'
        clusterOptions = '--job-name=alig --exclude=wuruwe,tokikura,v100'
        //containerOptions = '--bind /mnt/beegfs'
    }
    withName: 'fastqc_pre' {
        container = "./container/bwa.sif"
        cpus = 8
        memory = '32GB'
        queue = 'ngen-ko'
        clusterOptions = '--job-name=pre_trim --exclude=wuruwe,tokikura,v100'
        //containerOptions = '--bind /mnt/beegfs'
    }
    withName: 'fastqc_post' {
        container = "./container/bwa.sif"
        cpus = 8
        memory = '32GB'
        queue = 'ngen-ko'
        clusterOptions = '--job-name=post_trim --exclude=wuruwe,tokikura,v100'
        //containerOptions = '--bind /mnt/beegfs'
    }
    withName: 'fastp_trim' {
        container = "./container/bwa.sif"
        cpus = 24
        memory = '64GB'
        queue = 'ngen-ko'
        clusterOptions = '--job-name=trim --exclude=wuruwe,tokikura,v100'
        //containerOptions = '--bind /mnt/beegfs'
    }
}


profiles {
    kutral {
        apptainer.enabled       = true
        apptainer.runOptions    = '--bind /mnt/beegfs'
        singularity.enabled     = false
        singularity.autoMounts  = false
        conda.enabled           = false
        docker.enabled          = false
        podman.enabled          = false
        shifter.enabled         = false
        charliecloud.enabled    = false
        process.executor        = 'slurm'
        process.queue           = 'ngen-ko'
        executor.queueSize      = 15
    }
    local {
        apptainer.enabled       = true
        apptainer.runOptions    = '--bind /mnt/beegfs'
        singularity.enabled     = false
        conda.enabled           = false
        docker.enabled          = false
        podman.enabled          = false
        shifter.enabled         = false
        charliecloud.enabled    = false
    }
}


timeline {
    enabled = false
    file    = "${params.outdir}/pipeline_info/execution_timeline_${new java.util.Date().format('yyyy-MM-dd_HH-mm-ss')}.html"
}
report {
    enabled = false
    file    = "${params.outdir}/pipeline_info/execution_report_${new java.util.Date().format('yyyy-MM-dd_HH-mm-ss')}.html"
}
trace {
    enabled = false
    file    = "${params.outdir}/pipeline_info/execution_trace_${new java.util.Date().format('yyyy-MM-dd_HH-mm-ss')}.txt"
}
dag {
    enabled = false
    file    = "${params.outdir}/pipeline_info/pipeline_dag_${new java.util.Date().format('yyyy-MM-dd_HH-mm-ss')}.html"
}


manifest {
    defaultBranch = 'main'
    author = 'Cristian Herrera'
    version = '1.0.0'
}